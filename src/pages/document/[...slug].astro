---
import BaseLayout from '../../components/layout/BaseLayout.astro';
import HydrationWrapper from '../../components/HydrationWrapper.astro';
import DocumentViewerWrapper from '../../islands/DocumentViewerWrapper.tsx';

// This catch-all route handles all dynamic document routes
export async function getStaticPaths() {
  // Return a fallback path - this will be generated but all dynamic routes will fall through
  return [
    {
      params: { slug: 'fallback' },
      props: { isDynamic: true, title: 'Dynamic Document' }
    }
  ];
}

// Extract document ID from slug
const { slug } = Astro.params;
const documentId = Array.isArray(slug) ? slug.join('/') : slug;

console.log(`[Dynamic Route] Handling document ID: ${documentId}`);
---

<BaseLayout title="Document - LexMX">
  <main class="min-h-screen bg-white dark:bg-gray-900">
    <!-- Document Viewer Component -->
    <HydrationWrapper name="document-viewer">
      <DocumentViewerWrapper 
        documentId={documentId} 
        documentTitle="Document"
        client:load 
      />
    </HydrationWrapper>
  </main>
</BaseLayout>