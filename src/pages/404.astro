---
import BaseLayout from '../components/layout/BaseLayout.astro';
import HydrationWrapper from '../components/HydrationWrapper.astro';
import DocumentViewerWrapper from '../islands/DocumentViewerWrapper.tsx';

// Check if this is a document route that was dynamically generated
const url = Astro.url.pathname;
// Handle both local dev (no base path) and production (with /LexMX base)
const documentMatch = url.match(/^(?:\/LexMX)?\/document\/(.+)$/) || url.match(/^\/document\/(.+)$/);

let isDocumentRoute = false;
let documentId = '';

if (documentMatch) {
  isDocumentRoute = true;
  documentId = documentMatch[1];
  console.log('404 fallback handling document route:', documentId);
  console.log('404 page will render DocumentViewerWrapper with ID:', documentId);
}
---

{isDocumentRoute ? (
  <BaseLayout title={`Document - LexMX`}>
    <main class="min-h-screen bg-white dark:bg-gray-900">
      <!-- Document Viewer Component -->
      <HydrationWrapper name="document-viewer">
        <DocumentViewerWrapper 
          documentId={documentId} 
          documentTitle="Document"
          client:load 
        />
      </HydrationWrapper>
    </main>
  </BaseLayout>
) : (
  <BaseLayout title="404 - Page Not Found - LexMX">
    <main class="min-h-screen flex items-center justify-center bg-gray-50 dark:bg-gray-900">
      <div class="text-center">
        <h1 class="text-6xl font-bold text-gray-900 dark:text-white mb-4">404</h1>
        <h2 class="text-2xl font-semibold text-gray-700 dark:text-gray-300 mb-4">Page Not Found</h2>
        <p class="text-gray-600 dark:text-gray-400 mb-8">
          The page you are looking for does not exist.
        </p>
        <a 
          href="/" 
          class="bg-legal-600 hover:bg-legal-700 text-white px-6 py-3 rounded-lg transition-colors"
        >
          Go Home
        </a>
      </div>
    </main>
  </BaseLayout>
)}